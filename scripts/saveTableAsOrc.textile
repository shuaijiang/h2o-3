set hive.execution.engine=mr;
set mapreduce.map.memory.mb=5240;
set mapreduce.reduce.memory.mb=5240;
set mapreduce.map.java.opts=-DAMYWANG_MAP=1 -Xmx4G -XX:PermSize=256m -XX:MaxPermSize=256m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps;
set mapreduce.reduce.java.opts=-DAMYWANG_REDUCE=1 -Xmx4G -XX:PermSize=256m -XX:MaxPermSize=256m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps;
create table airlines_all_05p(
Year INT,
Month INT,
DayofMonth INT,
DayOfWeek INT,
DepTime INT,
CRSDepTime INT,
ArrTime INT,
CRSArrTime INT,
UniqueCarrier STRING,
FlightNum INT,
TailNum INT,
ActualElapsedTime INT,
CRSElapsedTime INT,
AirTime INT,
ArrDelay INT,
DepDelay INT,
Dest STRING,
Origin STRING,
Distance INT,
TaxiIn INT,
TaxiOut INT,
Cancelled INT,
CancellationCode STRING,
Diverted INT,
CarrierDelay INT,
WeatherDelay INT,
NASDelay INT,
SecurityDelay INT,
LateAircraftDelay INT,
IsArrDelayed STRING,
IsDepDelayed STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
location '/apps/hive/warehouse/data/airlines_all_05p';
load data inpath 'hdfs://mr-0xd6.0xdata.loc:8020/user/amy/airlines_all.05p.csv' into table airlines_all_05p;
create table orc_airlines_all_05p(
Year INT,
Month INT,
DayofMonth INT,
DayOfWeek INT,
DepTime INT,
CRSDepTime INT,
ArrTime INT,
CRSArrTime INT,
UniqueCarrier STRING,
FlightNum INT,
TailNum INT,
ActualElapsedTime INT,
CRSElapsedTime INT,
AirTime INT,
ArrDelay INT,
DepDelay INT,
Dest STRING,
Origin STRING,
Distance INT,
TaxiIn INT,
TaxiOut INT,
Cancelled INT,
CancellationCode STRING,
Diverted INT,
CarrierDelay INT,
WeatherDelay INT,
NASDelay INT,
SecurityDelay INT,
LateAircraftDelay INT,
IsArrDelayed STRING,
IsDepDelayed STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS ORC;
INSERT OVERWRITE TABLE orc_airlines_all_05p select * from airlines_all_05p;

The following is from Nidhi:
CREATE EXTERNAL TABLE ta (a1 INT, a2 STRING, a3 STRING, a4 STRING, a5 INT, a6 STRING, a7 INT, a8 INT, a9 INT)
STORED AS ORC;

LOAD DATA local INPATH '/home/wendy/demo-11-zlib.orc' OVERWRITE INTO TABLE ta;
​
select * from ta limit 3;
#OK
#1	M	M	Primary	500	Good	0	0	0
#2	F	M	Primary	500	Good	0	0	0
#3	M	S	Primary	500	Good	0	0	0
​
CREATE EXTERNAL TABLE aa (a1 INT, a2 STRING, a3 STRING, a4 STRING, a5 INT, a6 STRING, a7 INT, a8 INT, a9 INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY  ','
STORED AS TEXTFILE
LOCATION '/user/wendy/from_hive';
​
select * from aa limit 3;
#OK
#NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
#NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
#NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
​
INSERT OVERWRITE TABLE aa SELECT * FROM ta;
​
 select * from aa limit 3;
#OK
#1	M	M	Primary	500	Good	0	0	0
#2	F	M	Primary	500	Good	0	0	0
#3	M	S	Primary	500	Good	0	0	0
#Time taken: 0.079 seconds, Fetched: 3 row(s)


Convert csv to orc:
CREATE EXTERNAL TABLE da (a1 INT, a2 INT, a3 INT, a4 INT, a5 INT, a6 INT, a7 DOUBLE, a8 DOUBLE, a9 INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY  ','
 STORED AS TEXTFILE;
LOAD DATA local INPATH '/home/nidhi/prostate.csv' OVERWRITE INTO TABLE bb;
​
select * from da limit 3;
​
​
​
CREATE EXTERNAL TABLE bb (a1 INT, a2 INT, a3 INT, a4 INT, a5 INT, a6 INT, a7 DOUBLE, a8 DOUBLE, a9 INT)
STORED AS ORC
LOCATION '/user/nidhi/from_hive_prna';

INSERT OVERWRITE TABLE bb
SELECT *
FROM da;
​
select * from bb limit 3;

